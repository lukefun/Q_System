# Q_System é‡åŒ–äº¤æ˜“ç³»ç»Ÿ - å®Œæ•´å­¦ä¹ æŒ‡å—

> æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ä»é›¶å¼€å§‹ï¼Œç³»ç»Ÿæ€§åœ°å­¦ä¹ ä¸¤å‘¨çš„é‡åŒ–äº¤æ˜“ç³»ç»Ÿå¼€å‘å†…å®¹

## ğŸ“š å­¦ä¹ è·¯çº¿å›¾

```
ç¬¬ä¸€å‘¨: PythonåŸºç¡€ä¸ç¯å¢ƒæ­å»º (7å¤©)
    â†“
ç¬¬äºŒå‘¨: XtDataé‡‘èæ•°æ®å·¥ç¨‹ (7å¤©)
    â†“
ç»¼åˆå®æˆ˜: å®Œæ•´é‡åŒ–ç³»ç»Ÿå¼€å‘
```

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

### ç¬¬ä¸€å‘¨ç›®æ ‡
- æŒæ¡Pythonå¼€å‘ç¯å¢ƒé…ç½®
- ç†è§£è™šæ‹Ÿç¯å¢ƒéš”ç¦»åŸç†
- ç†Ÿæ‚‰Pandasæ•°æ®å¤„ç†
- æŒæ¡æ—¶é—´åºåˆ—åˆ†æåŸºç¡€

### ç¬¬äºŒå‘¨ç›®æ ‡
- æŒæ¡é‡‘èæ•°æ®è·å–ä¸å¤„ç†
- ç†è§£æ•°æ®è´¨é‡æ§åˆ¶æ–¹æ³•
- å­¦ä¼šæ„å»ºæœ¬åœ°æ•°æ®åº“
- æŒæ¡å›æµ‹ç³»ç»ŸåŸºç¡€æ¶æ„

---

## ğŸ“– ç¬¬ä¸€å‘¨ï¼šPythonå·¥ç¨‹åŸºç¡€

### Day 1: ç¯å¢ƒæ­å»ºä¸éš”ç¦» (2-3å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: ç†è§£Pythonç¯å¢ƒéš”ç¦»çš„é‡è¦æ€§ï¼ŒæŒæ¡Condaç¯å¢ƒç®¡ç†

**å¿…è¯»æ–‡æ¡£**:
1. `docs/ENVIRONMENT.md` - ç¯å¢ƒé…ç½®å®Œæ•´æŒ‡å—
2. `docs/notes/week1_day1_isolation_mode.md` - ç¯å¢ƒéš”ç¦»è¯¦è§£

**å®è·µæ­¥éª¤**:
```bash
# 1. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
conda create -n quants python=3.8
conda activate quants

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. éªŒè¯ç¯å¢ƒ
python exercises/week1/day1_env_check.py
```

**æ ¸å¿ƒæ¦‚å¿µ**:
- è™šæ‹Ÿç¯å¢ƒéš”ç¦»åŸç†
- ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ
- ç¯å¢ƒå˜é‡é…ç½®

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿç‹¬ç«‹åˆ›å»ºå’Œç®¡ç†Pythonè™šæ‹Ÿç¯å¢ƒ

---

### Day 2: PythonåŸºç¡€å›é¡¾ (3-4å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: å·©å›ºPythonæ ¸å¿ƒè¯­æ³•ï¼Œä¸ºé‡åŒ–å¼€å‘æ‰“åŸºç¡€

**å®è·µæ–‡ä»¶**:
- `exercises/week1/day2_python_basics.py`

**æ ¸å¿ƒå†…å®¹**:
- æ•°æ®ç±»å‹ä¸ç»“æ„
- å‡½æ•°å¼ç¼–ç¨‹
- é¢å‘å¯¹è±¡ç¼–ç¨‹
- å¼‚å¸¸å¤„ç†

**ç»ƒä¹ é‡ç‚¹**:
```python
# åˆ—è¡¨æ¨å¯¼å¼ - é‡åŒ–ä¸­å¸¸ç”¨
prices = [100, 101, 99, 102, 98]
returns = [(prices[i] - prices[i-1]) / prices[i-1] 
           for i in range(1, len(prices))]

# è£…é¥°å™¨ - ç”¨äºæ€§èƒ½ç›‘æ§
def timer(func):
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        print(f"è€—æ—¶: {time.time() - start:.2f}ç§’")
        return result
    return wrapper
```

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿç¼–å†™æ¸…æ™°ã€é«˜æ•ˆçš„Pythonä»£ç 

---

### Day 3: Pandasæ•°æ®å¤„ç† (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡Pandasåœ¨é‡‘èæ•°æ®å¤„ç†ä¸­çš„åº”ç”¨

**å®è·µæ–‡ä»¶**:
- `exercises/week1/day3_pandas_basics.py`

**æ ¸å¿ƒæŠ€èƒ½**:

1. **DataFrameåŸºç¡€æ“ä½œ**
   - æ•°æ®è¯»å–ä¸å†™å…¥
   - æ•°æ®é€‰æ‹©ä¸è¿‡æ»¤
   - æ•°æ®æ¸…æ´—ä¸è½¬æ¢

2. **é‡‘èæ•°æ®ç‰¹æœ‰æ“ä½œ**
   - æ—¶é—´ç´¢å¼•å¤„ç†
   - é‡é‡‡æ ·ä¸é¢‘ç‡è½¬æ¢
   - æ»šåŠ¨çª—å£è®¡ç®—

**å®æˆ˜ç¤ºä¾‹**:
```python
import pandas as pd

# è¯»å–è‚¡ç¥¨æ•°æ®
df = pd.read_csv('stock_data.csv', parse_dates=['date'])
df.set_index('date', inplace=True)

# è®¡ç®—ç§»åŠ¨å¹³å‡çº¿
df['MA5'] = df['close'].rolling(window=5).mean()
df['MA20'] = df['close'].rolling(window=20).mean()

# è®¡ç®—æ”¶ç›Šç‡
df['returns'] = df['close'].pct_change()
```

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿç‹¬ç«‹å¤„ç†å’Œåˆ†æè‚¡ç¥¨æ•°æ®

---

### Day 4: æ—¶é—´åºåˆ—åˆ†æ (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: ç†è§£é‡‘èæ—¶é—´åºåˆ—çš„ç‰¹æ€§å’Œå¤„ç†æ–¹æ³•

**å®è·µæ–‡ä»¶**:
- `exercises/week1/day4_timeseries.py`

**æ ¸å¿ƒæ¦‚å¿µ**:
- æ—¶é—´åºåˆ—ç´¢å¼•
- é¢‘ç‡è½¬æ¢ä¸å¯¹é½
- ç¼ºå¤±å€¼å¤„ç†
- å‰è§†åå·®(Lookahead Bias)é¢„é˜²

**å…³é”®æŠ€æœ¯**:
```python
# æ—¶é—´å¯¹é½ - é¿å…å‰è§†åå·®
df_aligned = df.shift(1)  # ä½¿ç”¨å‰ä¸€å¤©çš„æ•°æ®

# é‡é‡‡æ · - æ—¥çº¿è½¬å‘¨çº¿
df_weekly = df.resample('W').agg({
    'open': 'first',
    'high': 'max',
    'low': 'min',
    'close': 'last',
    'volume': 'sum'
})
```

**æ£€æŸ¥ç‚¹**: ç†è§£å¹¶èƒ½é¿å…å›æµ‹ä¸­çš„å‰è§†åå·®

---

### Day 5: é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ– (3-4å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡Pythoné¡¹ç›®ç»„ç»‡å’Œæ¨¡å—åŒ–å¼€å‘

**å¿…è¯»æ–‡æ¡£**:
- `docs/notes/week1_day5_project_structure.md`

**å®è·µæ–‡ä»¶**:
- `exercises/week1/day5_import_test.py`
- `exercises/week1/day5_module_test.py`

**é¡¹ç›®ç»“æ„**:
```
Q_System/
â”œâ”€â”€ src/              # æ ¸å¿ƒæºä»£ç 
â”œâ”€â”€ tests/            # æµ‹è¯•ä»£ç 
â”œâ”€â”€ examples/         # ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ exercises/        # ç»ƒä¹ ä»£ç 
â”œâ”€â”€ data/            # æ•°æ®å­˜å‚¨
â”œâ”€â”€ docs/            # æ–‡æ¡£
â””â”€â”€ config.py        # é…ç½®æ–‡ä»¶
```

**æ¨¡å—åŒ–åŸåˆ™**:
- å•ä¸€èŒè´£åŸåˆ™
- æ¥å£æ¸…æ™°
- ä½è€¦åˆé«˜å†…èš

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿè®¾è®¡æ¸…æ™°çš„é¡¹ç›®ç»“æ„

---

### Day 6: Gitç‰ˆæœ¬æ§åˆ¶ (2-3å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡GitåŸºæœ¬æ“ä½œå’Œåä½œæµç¨‹

**å¿…è¯»æ–‡æ¡£**:
- `docs/notes/week1_day6_git_version_control.md`

**æ ¸å¿ƒæ“ä½œ**:
```bash
# åˆå§‹åŒ–ä»“åº“
git init

# æ·»åŠ æ–‡ä»¶
git add .

# æäº¤æ›´æ”¹
git commit -m "feat: æ·»åŠ æ•°æ®å¤„ç†æ¨¡å—"

# æŸ¥çœ‹å†å²
git log --oneline

# åˆ†æ”¯ç®¡ç†
git branch feature/new-strategy
git checkout feature/new-strategy
```

**æäº¤è§„èŒƒ**:
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `test`: æµ‹è¯•ç›¸å…³
- `refactor`: ä»£ç é‡æ„

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿä½¿ç”¨Gitç®¡ç†ä»£ç ç‰ˆæœ¬

---

### Day 7: ç¬¬ä¸€å‘¨æ€»ç»“ä¸éªŒè¯ (2-3å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: å·©å›ºç¬¬ä¸€å‘¨æ‰€å­¦ï¼Œå‡†å¤‡è¿›å…¥ç¬¬äºŒå‘¨

**å¿…è¯»æ–‡æ¡£**:
- `docs/notes/week1_summary.md`

**éªŒè¯è„šæœ¬**:
```bash
python exercises/week1/day7_verify.py
```

**è‡ªæˆ‘æ£€æŸ¥æ¸…å•**:
- [ ] èƒ½å¤Ÿç‹¬ç«‹é…ç½®Pythonå¼€å‘ç¯å¢ƒ
- [ ] ç†Ÿç»ƒä½¿ç”¨Pandaså¤„ç†æ•°æ®
- [ ] ç†è§£æ—¶é—´åºåˆ—çš„ç‰¹æ®Šæ€§
- [ ] æŒæ¡é¡¹ç›®ç»„ç»‡å’Œæ¨¡å—åŒ–
- [ ] èƒ½å¤Ÿä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶

---

## ğŸ“Š ç¬¬äºŒå‘¨ï¼šXtDataé‡‘èæ•°æ®å·¥ç¨‹

### å­¦ä¹ å‰å‡†å¤‡

**ç¯å¢ƒè¦æ±‚**:
```bash
# ç¡®ä¿åœ¨quantsç¯å¢ƒä¸­
conda activate quants

# å®‰è£…Week2ä¾èµ–
pip install tables matplotlib hypothesis pytest
```

**é…ç½®XtData**:
1. åœ¨`.env`æ–‡ä»¶ä¸­é…ç½®è´¦å·ä¿¡æ¯
2. å‚è€ƒ`docs/xtdata.md`äº†è§£APIè¯¦æƒ…

---

### Day 8: XtDataåŸºç¡€ (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡XtData APIçš„åŸºæœ¬ä½¿ç”¨

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/xtdata_client.py` - XtDataå®¢æˆ·ç«¯å°è£…
- `src/data_retriever.py` - æ•°æ®è·å–å™¨
- `examples/01_basic_data_retrieval.py` - åŸºç¡€ç¤ºä¾‹

**å®è·µæ­¥éª¤**:

1. **ç†è§£XtDataå®¢æˆ·ç«¯å°è£…**
```python
# é˜…è¯» src/xtdata_client.py
# é‡ç‚¹å…³æ³¨:
# - è¿æ¥ç®¡ç†
# - é”™è¯¯å¤„ç†
# - æ—¥å¿—è®°å½•
```

2. **è¿è¡ŒåŸºç¡€ç¤ºä¾‹**
```bash
python examples/01_basic_data_retrieval.py
```

3. **å®Œæˆç»ƒä¹ **
```bash
python exercises/week2/day8_xtdata_basics.py
```

**æ ¸å¿ƒæ¦‚å¿µ**:
- è¡Œæƒ…æ•°æ®ç±»å‹(æ—¥çº¿ã€åˆ†é’Ÿçº¿)
- æ•°æ®å­—æ®µå«ä¹‰(OHLCV)
- APIé™æµå¤„ç†
- é”™è¯¯é‡è¯•æœºåˆ¶

**å®æˆ˜ä»»åŠ¡**:
- è·å–å•åªè‚¡ç¥¨çš„å†å²æ•°æ®
- æ‰¹é‡è·å–å¤šåªè‚¡ç¥¨æ•°æ®
- å¤„ç†APIå¼‚å¸¸æƒ…å†µ

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿç¨³å®šè·å–è‚¡ç¥¨è¡Œæƒ…æ•°æ®

---

### Day 9: ä»·æ ¼å¤æƒå¤„ç† (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: ç†è§£å¤æƒåŸç†ï¼ŒæŒæ¡ä»·æ ¼è°ƒæ•´æ–¹æ³•

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/price_adjuster.py` - ä»·æ ¼å¤æƒå¤„ç†å™¨
- `examples/02_price_adjustment.py` - å¤æƒç¤ºä¾‹

**å¤æƒç±»å‹**:

1. **å‰å¤æƒ(Forward Adjustment)**
   - ä¿æŒæœ€æ–°ä»·æ ¼ä¸å˜
   - å‘å‰è°ƒæ•´å†å²ä»·æ ¼
   - é€‚åˆæŠ€æœ¯åˆ†æ

2. **åå¤æƒ(Backward Adjustment)**
   - ä¿æŒå†å²ä»·æ ¼ä¸å˜
   - å‘åè°ƒæ•´å½“å‰ä»·æ ¼
   - é€‚åˆæ”¶ç›Šç‡è®¡ç®—

3. **ä¸å¤æƒ(No Adjustment)**
   - ä¿æŒåŸå§‹ä»·æ ¼
   - ç”¨äºç‰¹å®šåˆ†æåœºæ™¯

**å®è·µä»£ç **:
```python
from src.price_adjuster import PriceAdjuster

adjuster = PriceAdjuster()

# å‰å¤æƒ
df_forward = adjuster.adjust_price(
    df, 
    method='forward',
    adjust_columns=['open', 'high', 'low', 'close']
)

# éªŒè¯å¤æƒæ­£ç¡®æ€§
adjuster.validate_adjustment(df, df_forward)
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day9_price_adjustment.py
```

**å…³é”®ç‚¹**:
- é™¤æƒé™¤æ¯æ—¥æœŸè¯†åˆ«
- å¤æƒå› å­è®¡ç®—
- æˆäº¤é‡ä¸éœ€è¦å¤æƒ
- å¤æƒåæ•°æ®éªŒè¯

**æ£€æŸ¥ç‚¹**: ç†è§£å¤æƒåŸç†å¹¶èƒ½æ­£ç¡®åº”ç”¨

---

### Day 10: åŸºæœ¬é¢æ•°æ®å¤„ç† (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡è´¢åŠ¡æ•°æ®è·å–å’Œå¤„ç†æ–¹æ³•

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/fundamental_handler.py` - åŸºæœ¬é¢æ•°æ®å¤„ç†å™¨
- `examples/03_fundamental_data.py` - åŸºæœ¬é¢ç¤ºä¾‹

**æ•°æ®ç±»å‹**:

1. **è´¢åŠ¡æŠ¥è¡¨æ•°æ®**
   - èµ„äº§è´Ÿå€ºè¡¨
   - åˆ©æ¶¦è¡¨
   - ç°é‡‘æµé‡è¡¨

2. **è´¢åŠ¡æŒ‡æ ‡**
   - ç›ˆåˆ©èƒ½åŠ›(ROE, ROA)
   - å¿å€ºèƒ½åŠ›(èµ„äº§è´Ÿå€ºç‡)
   - æˆé•¿èƒ½åŠ›(è¥æ”¶å¢é•¿ç‡)

**å®è·µç¤ºä¾‹**:
```python
from src.fundamental_handler import FundamentalHandler

handler = FundamentalHandler()

# è·å–è´¢åŠ¡æ•°æ®
financial_data = handler.get_financial_data(
    stock_code='000001.SZ',
    start_date='2020-01-01',
    end_date='2023-12-31'
)

# è®¡ç®—è´¢åŠ¡æŒ‡æ ‡
metrics = handler.calculate_metrics(financial_data)
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day10_fundamental_data.py
```

**æ³¨æ„äº‹é¡¹**:
- è´¢åŠ¡æ•°æ®å‘å¸ƒæ—¶é—´æ»å
- é¿å…ä½¿ç”¨æœªæ¥æ•°æ®(å‰è§†åå·®)
- æ•°æ®ç¼ºå¤±å¤„ç†

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿè·å–å’Œåˆ†æè´¢åŠ¡æ•°æ®

---

### Day 11: è¡Œä¸šåˆ†ç±»æ˜ å°„ (3-4å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡è¡Œä¸šåˆ†ç±»ä½“ç³»å’Œè‚¡ç¥¨åˆ†ç±»æ–¹æ³•

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/industry_mapper.py` - è¡Œä¸šåˆ†ç±»æ˜ å°„å™¨
- `examples/04_industry_classification.py` - åˆ†ç±»ç¤ºä¾‹

**åˆ†ç±»æ ‡å‡†**:
- ç”³ä¸‡è¡Œä¸šåˆ†ç±»
- ä¸­ä¿¡è¡Œä¸šåˆ†ç±»
- è¯ç›‘ä¼šè¡Œä¸šåˆ†ç±»

**å®è·µä»£ç **:
```python
from src.industry_mapper import IndustryMapper

mapper = IndustryMapper()

# è·å–è‚¡ç¥¨è¡Œä¸š
industry = mapper.get_stock_industry('000001.SZ')

# è·å–è¡Œä¸šå†…æ‰€æœ‰è‚¡ç¥¨
stocks = mapper.get_industry_stocks('é“¶è¡Œ')

# è¡Œä¸šè½®åŠ¨åˆ†æ
rotation = mapper.analyze_industry_rotation(
    start_date='2023-01-01',
    end_date='2023-12-31'
)
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day11_industry_classification.py
```

**åº”ç”¨åœºæ™¯**:
- è¡Œä¸šè½®åŠ¨ç­–ç•¥
- è¡Œä¸šä¸­æ€§ç­–ç•¥
- æ¿å—åˆ†æ

**æ£€æŸ¥ç‚¹**: ç†è§£è¡Œä¸šåˆ†ç±»å¹¶èƒ½åº”ç”¨äºç­–ç•¥

---

### Day 12: æ•°æ®æŒä¹…åŒ– (4-5å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡HDF5æ•°æ®åº“çš„ä½¿ç”¨å’Œæ•°æ®ç®¡ç†

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/data_manager.py` - æ•°æ®ç®¡ç†å™¨
- `examples/05_data_persistence.py` - æŒä¹…åŒ–ç¤ºä¾‹

**HDF5ä¼˜åŠ¿**:
- é«˜æ€§èƒ½è¯»å†™
- æ”¯æŒå¤§æ•°æ®é›†
- æ•°æ®å‹ç¼©
- å±‚æ¬¡åŒ–ç»“æ„

**å®è·µä»£ç **:
```python
from src.data_manager import DataManager

manager = DataManager(db_path='data/market_data.h5')

# ä¿å­˜æ•°æ®
manager.save_stock_data(
    stock_code='000001.SZ',
    data=df,
    data_type='daily'
)

# è¯»å–æ•°æ®
df = manager.load_stock_data(
    stock_code='000001.SZ',
    start_date='2023-01-01',
    end_date='2023-12-31'
)

# å¢é‡æ›´æ–°
manager.update_stock_data(
    stock_code='000001.SZ',
    new_data=new_df
)
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day12_data_persistence.py
```

**æœ€ä½³å®è·µ**:
- å®šæœŸå¤‡ä»½æ•°æ®
- ä½¿ç”¨å‹ç¼©èŠ‚çœç©ºé—´
- å»ºç«‹ç´¢å¼•åŠ é€ŸæŸ¥è¯¢
- å¢é‡æ›´æ–°è€Œéå…¨é‡

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿé«˜æ•ˆç®¡ç†æœ¬åœ°æ•°æ®åº“

---

### Day 13: æ•°æ®å¯è§†åŒ– (3-4å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æŒæ¡é‡‘èæ•°æ®å¯è§†åŒ–æŠ€æœ¯

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/visualizer.py` - å¯è§†åŒ–å·¥å…·
- `examples/06_visualization.py` - å¯è§†åŒ–ç¤ºä¾‹

**å›¾è¡¨ç±»å‹**:

1. **Kçº¿å›¾(Candlestick)**
```python
from src.visualizer import Visualizer

viz = Visualizer()

# ç»˜åˆ¶Kçº¿å›¾
viz.plot_candlestick(
    df,
    title='000001.SZ æ—¥Kçº¿å›¾',
    show_volume=True
)
```

2. **æŠ€æœ¯æŒ‡æ ‡å›¾**
```python
# æ·»åŠ ç§»åŠ¨å¹³å‡çº¿
viz.add_moving_average(df, periods=[5, 10, 20])

# æ·»åŠ MACD
viz.add_macd(df)
```

3. **æ”¶ç›Šç‡åˆ†å¸ƒ**
```python
# ç»˜åˆ¶æ”¶ç›Šç‡åˆ†å¸ƒ
viz.plot_returns_distribution(df['returns'])
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day13_visualization.py
```

**å¯è§†åŒ–åŸåˆ™**:
- æ¸…æ™°è¡¨è¾¾æ•°æ®ç‰¹å¾
- åˆç†ä½¿ç”¨é¢œè‰²
- æ·»åŠ å¿…è¦æ³¨é‡Š
- æ”¯æŒäº¤äº’æ¢ç´¢

**æ£€æŸ¥ç‚¹**: èƒ½å¤Ÿåˆ›å»ºä¸“ä¸šçš„é‡‘èå›¾è¡¨

---

### Day 14: æ„å»ºå®Œæ•´å¸‚åœºæ•°æ®åº“ (5-6å°æ—¶)

**å­¦ä¹ ç›®æ ‡**: æ„å»ºåŒ…å«å…¨å¸‚åœºè‚¡ç¥¨çš„æœ¬åœ°æ•°æ®åº“

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/full_market_downloader.py` - å…¨å¸‚åœºä¸‹è½½å™¨
- `examples/09_build_local_database.py` - æ•°æ®åº“æ„å»ºç¤ºä¾‹

**å®æ–½æ­¥éª¤**:

1. **è·å–è‚¡ç¥¨åˆ—è¡¨**
```python
from src.full_market_downloader import FullMarketDownloader

downloader = FullMarketDownloader()

# è·å–å…¨å¸‚åœºè‚¡ç¥¨ä»£ç 
stock_list = downloader.get_all_stocks()
print(f"å…±æœ‰ {len(stock_list)} åªè‚¡ç¥¨")
```

2. **æ‰¹é‡ä¸‹è½½æ•°æ®**
```python
# å¹¶è¡Œä¸‹è½½(æ³¨æ„APIé™æµ)
downloader.download_all_stocks(
    stock_list=stock_list,
    start_date='2020-01-01',
    end_date='2023-12-31',
    workers=4  # å¹¶è¡Œçº¿ç¨‹æ•°
)
```

3. **å¢é‡æ›´æ–°**
```python
# æ¯æ—¥æ›´æ–°
downloader.incremental_update(
    stock_list=stock_list,
    update_days=1
)
```

**ç»ƒä¹ ä»»åŠ¡**:
```bash
python exercises/week2/day14_full_market_db.py
```

**æ€§èƒ½ä¼˜åŒ–**:
- ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œä¸‹è½½
- å®ç°æ–­ç‚¹ç»­ä¼ 
- é”™è¯¯é‡è¯•æœºåˆ¶
- è¿›åº¦ç›‘æ§

**æ•°æ®è´¨é‡æ£€æŸ¥**:
- æ•°æ®å®Œæ•´æ€§éªŒè¯
- å¼‚å¸¸å€¼æ£€æµ‹
- ç¼ºå¤±å€¼å¤„ç†

**æ£€æŸ¥ç‚¹**: æˆåŠŸæ„å»ºæœ¬åœ°å¸‚åœºæ•°æ®åº“

---

## ğŸš€ ç»¼åˆå®æˆ˜é¡¹ç›®

### é¡¹ç›®1: å®Œæ•´æ•°æ®å·¥ä½œæµ (Day 15-16)

**ç›®æ ‡**: æ•´åˆæ‰€æœ‰æ¨¡å—ï¼Œæ„å»ºç«¯åˆ°ç«¯æ•°æ®å¤„ç†æµç¨‹

**å‚è€ƒæ–‡ä»¶**:
- `examples/08_full_workflow.py`

**å·¥ä½œæµç¨‹**:
```python
# 1. æ•°æ®è·å–
retriever = DataRetriever()
raw_data = retriever.get_market_data(
    stock_list=['000001.SZ', '600000.SH'],
    start_date='2023-01-01',
    end_date='2023-12-31'
)

# 2. ä»·æ ¼å¤æƒ
adjuster = PriceAdjuster()
adjusted_data = adjuster.adjust_price(raw_data, method='forward')

# 3. æ•°æ®å¯¹é½
from src.data_alignment import DataAlignment
aligner = DataAlignment()
aligned_data = aligner.align_multiple_stocks(adjusted_data)

# 4. æ·»åŠ åŸºæœ¬é¢æ•°æ®
fundamental = FundamentalHandler()
enriched_data = fundamental.enrich_with_fundamentals(aligned_data)

# 5. æ•°æ®å­˜å‚¨
manager = DataManager()
manager.save_processed_data(enriched_data)

# 6. æ•°æ®å¯è§†åŒ–
visualizer = Visualizer()
visualizer.create_dashboard(enriched_data)
```

**å®æˆ˜ä»»åŠ¡**:
1. ä¸‹è½½æ²ªæ·±300æˆåˆ†è‚¡æ•°æ®
2. è¿›è¡Œå¤æƒå’Œå¯¹é½å¤„ç†
3. æ·»åŠ è´¢åŠ¡æŒ‡æ ‡
4. å­˜å‚¨åˆ°æœ¬åœ°æ•°æ®åº“
5. ç”Ÿæˆåˆ†ææŠ¥å‘Š

---

### é¡¹ç›®2: å‰è§†åå·®æ£€æµ‹ç³»ç»Ÿ (Day 17)

**ç›®æ ‡**: ç†è§£å¹¶é¢„é˜²å›æµ‹ä¸­çš„å‰è§†åå·®

**å‚è€ƒæ–‡ä»¶**:
- `examples/10_lookahead_bias_demo.py`

**å‰è§†åå·®ç±»å‹**:

1. **æ•°æ®å¯¹é½åå·®**
```python
# é”™è¯¯ç¤ºä¾‹ - ä½¿ç”¨å½“å¤©æ”¶ç›˜ä»·åšå†³ç­–
signal = df['close'] > df['close'].rolling(20).mean()

# æ­£ç¡®ç¤ºä¾‹ - ä½¿ç”¨å‰ä¸€å¤©æ•°æ®
signal = df['close'].shift(1) > df['close'].shift(1).rolling(20).mean()
```

2. **è´¢åŠ¡æ•°æ®åå·®**
```python
# é”™è¯¯ - ä½¿ç”¨æŠ¥å‘ŠæœŸæ•°æ®
df['pe'] = df['price'] / df['eps']

# æ­£ç¡® - ä½¿ç”¨å‘å¸ƒæ—¥æœŸ
df['pe'] = df['price'] / df['eps'].shift(reporting_lag)
```

3. **ç”Ÿå­˜åå·®**
```python
# ä½¿ç”¨å†å²è‚¡ç¥¨æ± ï¼ŒåŒ…å«å·²é€€å¸‚è‚¡ç¥¨
stock_universe = get_historical_universe(date)
```

**æ£€æµ‹å·¥å…·**:
```python
from src.data_alignment import DataAlignment

aligner = DataAlignment()

# æ£€æµ‹å‰è§†åå·®
bias_report = aligner.detect_lookahead_bias(
    strategy_data=strategy_df,
    market_data=market_df
)
```

**å®æˆ˜ä»»åŠ¡**:
1. è¯†åˆ«ç¤ºä¾‹ä»£ç ä¸­çš„å‰è§†åå·®
2. ä¿®æ­£åå·®å¹¶å¯¹æ¯”ç»“æœ
3. å»ºç«‹åå·®æ£€æµ‹æµç¨‹

---

## ğŸ§ª æµ‹è¯•é©±åŠ¨å¼€å‘

### å•å…ƒæµ‹è¯• (Unit Tests)

**ä½ç½®**: `tests/unit/`

**è¿è¡Œæ–¹å¼**:
```bash
# è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
pytest tests/unit/ -v

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
pytest tests/unit/test_data_retriever.py -v

# æŸ¥çœ‹è¦†ç›–ç‡
pytest tests/unit/ --cov=src --cov-report=html
```

**æµ‹è¯•ç¤ºä¾‹**:
```python
# tests/unit/test_price_adjuster.py
def test_forward_adjustment():
    """æµ‹è¯•å‰å¤æƒè®¡ç®—æ­£ç¡®æ€§"""
    adjuster = PriceAdjuster()
    
    # å‡†å¤‡æµ‹è¯•æ•°æ®
    df = create_test_data()
    
    # æ‰§è¡Œå¤æƒ
    result = adjuster.adjust_price(df, method='forward')
    
    # éªŒè¯ç»“æœ
    assert result['close'].iloc[-1] == df['close'].iloc[-1]
    assert result['close'].iloc[0] < df['close'].iloc[0]
```

---

### å±æ€§æµ‹è¯• (Property-Based Tests)

**ä½ç½®**: `tests/property/`

**æ ¸å¿ƒæ€æƒ³**: éªŒè¯ä»£ç åœ¨å„ç§è¾“å…¥ä¸‹éƒ½æ»¡è¶³ç‰¹å®šå±æ€§

**è¿è¡Œæ–¹å¼**:
```bash
# è¿è¡Œå±æ€§æµ‹è¯•
pytest tests/property/ -v

# è¿è¡Œç‰¹å®šå±æ€§æµ‹è¯•
pytest tests/property/test_properties_adjustment.py -v
```

**æµ‹è¯•ç¤ºä¾‹**:
```python
from hypothesis import given, strategies as st

@given(st.lists(st.floats(min_value=1, max_value=1000), min_size=10))
def test_adjustment_preserves_returns(prices):
    """å±æ€§: å¤æƒä¸æ”¹å˜æ”¶ç›Šç‡"""
    df = pd.DataFrame({'close': prices})
    
    # è®¡ç®—åŸå§‹æ”¶ç›Šç‡
    original_returns = df['close'].pct_change()
    
    # å¤æƒåæ”¶ç›Šç‡
    adjusted = adjuster.adjust_price(df, method='forward')
    adjusted_returns = adjusted['close'].pct_change()
    
    # éªŒè¯æ”¶ç›Šç‡ç›¸ç­‰
    assert np.allclose(original_returns, adjusted_returns, rtol=1e-5)
```

**å…³é”®å±æ€§**:
- æ•°æ®å®Œæ•´æ€§ä¿æŒ
- æ”¶ç›Šç‡ä¸å˜æ€§
- æ—¶é—´é¡ºåºä¿æŒ
- æ— å‰è§†åå·®

---

### é›†æˆæµ‹è¯• (Integration Tests)

**ä½ç½®**: `tests/integration/`

**æµ‹è¯•èŒƒå›´**: å¤šä¸ªæ¨¡å—ååŒå·¥ä½œ

**è¿è¡Œæ–¹å¼**:
```bash
# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/ -v
```

**æµ‹è¯•åœºæ™¯**:
1. å®Œæ•´æ•°æ®å·¥ä½œæµ
2. å…¨å¸‚åœºæ•°æ®åº“æ„å»º
3. å¢é‡æ›´æ–°æµç¨‹

---

## ğŸ“ ä»£ç è´¨é‡æ£€æŸ¥

### ä»£ç é£æ ¼æ£€æŸ¥
```bash
# ä½¿ç”¨flake8æ£€æŸ¥ä»£ç é£æ ¼
flake8 src/ --max-line-length=100

# ä½¿ç”¨blackæ ¼å¼åŒ–ä»£ç 
black src/ tests/
```

### ç±»å‹æ£€æŸ¥
```bash
# ä½¿ç”¨mypyè¿›è¡Œç±»å‹æ£€æŸ¥
mypy src/ --ignore-missing-imports
```

### æ–‡æ¡£æ£€æŸ¥
```bash
# éªŒè¯æ–‡æ¡£å®Œæ•´æ€§
python scripts/verify_documentation.py
```

---

## ğŸ“ è¿›é˜¶å­¦ä¹ èµ„æº

### æ¨èé˜…è¯»

1. **é‡åŒ–äº¤æ˜“åŸºç¡€**
   - ã€Šé‡åŒ–æŠ•èµ„ï¼šä»¥Pythonä¸ºå·¥å…·ã€‹
   - ã€ŠPythoné‡‘èå¤§æ•°æ®åˆ†æã€‹

2. **æ•°æ®å·¥ç¨‹**
   - ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹
   - ã€Šé«˜æ€§èƒ½Pythonã€‹

3. **æµ‹è¯•é©±åŠ¨å¼€å‘**
   - ã€Šæµ‹è¯•é©±åŠ¨å¼€å‘ã€‹(Kent Beck)
   - ã€ŠPythonæµ‹è¯•é©±åŠ¨å¼€å‘ã€‹

### åœ¨çº¿èµ„æº

- [Pandaså®˜æ–¹æ–‡æ¡£](https://pandas.pydata.org/docs/)
- [Hypothesisæ–‡æ¡£](https://hypothesis.readthedocs.io/)
- [é‡åŒ–äº¤æ˜“ç¤¾åŒº](https://www.joinquant.com/)

---

## ğŸ” å¸¸è§é—®é¢˜è§£ç­”

### Q1: ç¯å¢ƒé…ç½®å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
**A**: å‚è€ƒ`ENVIRONMENT_FIX_SUMMARY.md`ï¼Œç¡®ä¿ï¼š
- ä½¿ç”¨æ­£ç¡®çš„Pythonç‰ˆæœ¬(3.8)
- åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…ä¾èµ–
- æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®

### Q2: XtDataè¿æ¥å¤±è´¥ï¼Ÿ
**A**: æ£€æŸ¥ï¼š
- è´¦å·é…ç½®æ˜¯å¦æ­£ç¡®
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
- APIé™æµæ˜¯å¦è§¦å‘

### Q3: æ•°æ®ä¸‹è½½å¾ˆæ…¢ï¼Ÿ
**A**: ä¼˜åŒ–æ–¹æ³•ï¼š
- ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œä¸‹è½½
- å®ç°å¢é‡æ›´æ–°
- ä½¿ç”¨æœ¬åœ°ç¼“å­˜

### Q4: æµ‹è¯•å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
**A**: æ’æŸ¥æ­¥éª¤ï¼š
1. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æµ‹è¯•æ•°æ®
3. éªŒè¯ç¯å¢ƒé…ç½®
4. å‚è€ƒæµ‹è¯•æ–‡æ¡£

### Q5: å¦‚ä½•é¿å…å‰è§†åå·®ï¼Ÿ
**A**: å…³é”®åŸåˆ™ï¼š
- ä½¿ç”¨shift()å»¶è¿Ÿæ•°æ®
- æ³¨æ„è´¢åŠ¡æ•°æ®å‘å¸ƒæ—¶é—´
- ä½¿ç”¨å†å²è‚¡ç¥¨æ± 
- è¿è¡Œåå·®æ£€æµ‹å·¥å…·

---

## âœ… å­¦ä¹ æ£€æŸ¥æ¸…å•

### ç¬¬ä¸€å‘¨æ£€æŸ¥æ¸…å•
- [ ] èƒ½å¤Ÿç‹¬ç«‹é…ç½®Pythonå¼€å‘ç¯å¢ƒ
- [ ] ç†Ÿç»ƒä½¿ç”¨Pandaså¤„ç†æ•°æ®
- [ ] ç†è§£æ—¶é—´åºåˆ—çš„ç‰¹æ®Šæ€§
- [ ] æŒæ¡é¡¹ç›®ç»„ç»‡å’Œæ¨¡å—åŒ–
- [ ] èƒ½å¤Ÿä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶
- [ ] å®Œæˆæ‰€æœ‰Day1-7ç»ƒä¹ 

### ç¬¬äºŒå‘¨æ£€æŸ¥æ¸…å•
- [ ] èƒ½å¤Ÿä½¿ç”¨XtDataè·å–å¸‚åœºæ•°æ®
- [ ] ç†è§£å¹¶æ­£ç¡®åº”ç”¨ä»·æ ¼å¤æƒ
- [ ] èƒ½å¤Ÿå¤„ç†åŸºæœ¬é¢æ•°æ®
- [ ] æŒæ¡è¡Œä¸šåˆ†ç±»å’Œåº”ç”¨
- [ ] èƒ½å¤Ÿç®¡ç†æœ¬åœ°æ•°æ®åº“
- [ ] æŒæ¡æ•°æ®å¯è§†åŒ–æŠ€æœ¯
- [ ] æ„å»ºå®Œæ•´å¸‚åœºæ•°æ®åº“
- [ ] ç†è§£å¹¶èƒ½é¢„é˜²å‰è§†åå·®
- [ ] å®Œæˆæ‰€æœ‰Day8-14ç»ƒä¹ 

### ç»¼åˆèƒ½åŠ›æ£€æŸ¥æ¸…å•
- [ ] èƒ½å¤Ÿè®¾è®¡å®Œæ•´çš„æ•°æ®å¤„ç†æµç¨‹
- [ ] èƒ½å¤Ÿç¼–å†™é«˜è´¨é‡çš„æµ‹è¯•ä»£ç 
- [ ] èƒ½å¤Ÿè¿›è¡Œä»£ç å®¡æŸ¥å’Œä¼˜åŒ–
- [ ] èƒ½å¤Ÿç‹¬ç«‹è§£å†³æŠ€æœ¯é—®é¢˜
- [ ] èƒ½å¤Ÿé˜…è¯»å’Œç†è§£é¡¹ç›®æ–‡æ¡£
- [ ] èƒ½å¤Ÿä¸ºé¡¹ç›®è´¡çŒ®ä»£ç 

---

## ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ æ–¹å‘

å®Œæˆä¸¤å‘¨å­¦ä¹ åï¼Œä½ å¯ä»¥ç»§ç»­ï¼š

1. **ç­–ç•¥å¼€å‘**
   - å­¦ä¹ å¸¸è§é‡åŒ–ç­–ç•¥
   - å®ç°è‡ªå·±çš„äº¤æ˜“ç­–ç•¥
   - è¿›è¡Œç­–ç•¥å›æµ‹å’Œä¼˜åŒ–

2. **é£é™©ç®¡ç†**
   - å­¦ä¹ é£é™©åº¦é‡æ–¹æ³•
   - å®ç°é£é™©æ§åˆ¶ç³»ç»Ÿ
   - è¿›è¡Œå‹åŠ›æµ‹è¯•

3. **å®ç›˜äº¤æ˜“**
   - å­¦ä¹ XtTrader API
   - å®ç°è‡ªåŠ¨åŒ–äº¤æ˜“
   - è¿›è¡Œå®ç›˜ç›‘æ§

4. **æœºå™¨å­¦ä¹ åº”ç”¨**
   - ç‰¹å¾å·¥ç¨‹
   - æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°
   - æ¨¡å‹éƒ¨ç½²

---

## ğŸ“ è·å–å¸®åŠ©

é‡åˆ°é—®é¢˜æ—¶ï¼š

1. **æŸ¥é˜…æ–‡æ¡£**: å…ˆæŸ¥çœ‹ç›¸å…³æ–‡æ¡£å’Œä»£ç æ³¨é‡Š
2. **è¿è¡Œç¤ºä¾‹**: å‚è€ƒexamplesç›®å½•ä¸‹çš„ç¤ºä¾‹ä»£ç 
3. **æŸ¥çœ‹æµ‹è¯•**: æµ‹è¯•ä»£ç å±•ç¤ºäº†æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼
4. **è°ƒè¯•ä»£ç **: ä½¿ç”¨print()æˆ–è°ƒè¯•å™¨å®šä½é—®é¢˜
5. **æŸ¥çœ‹æ—¥å¿—**: æ£€æŸ¥logsç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶

---

## ğŸ‰ ç»“è¯­

é‡åŒ–äº¤æ˜“æ˜¯ä¸€ä¸ªéœ€è¦æŒç»­å­¦ä¹ å’Œå®è·µçš„é¢†åŸŸã€‚è¿™ä¸¤å‘¨çš„å­¦ä¹ åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œé‡è¦çš„æ˜¯ï¼š

- **åŠ¨æ‰‹å®è·µ**: ç†è®ºç»“åˆå®è·µï¼Œå¤šå†™ä»£ç 
- **æŒç»­å­¦ä¹ **: å…³æ³¨è¡Œä¸šåŠ¨æ€ï¼Œå­¦ä¹ æ–°æŠ€æœ¯
- **ä¸¥è°¨æ€åº¦**: æ³¨é‡ä»£ç è´¨é‡å’Œæ•°æ®å‡†ç¡®æ€§
- **é£é™©æ„è¯†**: å§‹ç»ˆä¿æŒå¯¹å¸‚åœºçš„æ•¬ç•

ç¥ä½ å­¦ä¹ é¡ºåˆ©ï¼Œåœ¨é‡åŒ–äº¤æ˜“çš„é“è·¯ä¸Šè¶Šèµ°è¶Šè¿œï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-01-20  
**ç»´æŠ¤è€…**: Q_System Team
