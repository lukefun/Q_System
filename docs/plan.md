# Q_System 全栈量化架构师 120天深度养成计划

## 总览
- **核心目标**：独立构建一套集「数据清洗、回测验证、实盘交易、风控监控」于一体的 Python 量化系统
- **核心哲学**：工程先行（搭建骨架）→ 理论填充（注入灵魂）→ 实战硬化（打磨血肉）
- **时间预算**：120天（全职），每日有效学习/开发时长 6-8 小时

---

## 第一阶段：基础设施与金融扫盲 (Day 1 - Day 30)
**阶段目标**：掌握 Python 数据处理能力，建立基础金融认知，跑通最小交易闭环

### Week 1: 环境搭建与 Python 工程化规范
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 1 | 绝对环境配置 | 重装 Python 3.8 环境、配置 MiniQMT/IDE，产出 `check_env.py` 脚本（全绿通过） |
| Day 2 | Python 核心语法特训（量化定制版） | 列表推导式、字典 `dict.get`、异常处理 `try-except-finally`、装饰器基础 |
| Day 3 | Pandas 数据清洗（Series/DataFrame） | 索引 `loc/iloc`、缺失值 `fillna/dropna`、数据合并 `merge/concat` |
| Day 4 | Pandas 进阶（时间序列） | `resample`（K线周期转换）、`rolling`（移动平均）、`shift/diff`（涨跌计算） |
| Day 5 | 项目结构设计 | 标准化目录：`core`/`data`/`strategies`/`logs`/`config`，理解 `__init__.py` 作用 |
| Day 6 | Git 版本控制 | 掌握 `git init/commit/branch/revert`，强制要求代码备份 |
| Day 7 | 周复盘与代码重构 | 清理零散脚本，整理为可复用函数库 |

### Week 2: 金融数据工程 (XtData)
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 8 | XtData 基础接口 | 掌握 `download_history_data`/`get_market_data`，区分 tick 数据与 1d 数据 |
| Day 9 | 复权与除权除息（量化知识补课） | 理解前复权/后复权逻辑，验证回测必须用前复权的原因，对比复权/不复权 K线差异 |
| Day 10 | 财务数据 ETL | 获取 PE/PB/ROE 数据，处理财务数据发布滞后性（规避未来函数） |
| Day 11 | 板块与行业数据 | 获取申万行业分类，构建「行业-股票」映射字典 |
| Day 12 | 数据持久化（HDF5/CSV） | 编写 `DataManager` 类，实现数据增量更新（仅下载本地缺失的最新数据） |
| Day 13 | 简单可视化 | 使用 Matplotlib 绘制带均线、成交量的 K 线图 |
| Day 14 | 周复盘 | 构建本地「全市场日线数据库」 |

### Week 3: 金融市场微观结构（量化扫盲）
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 15 | 订单与成交 | 理解限价单/市价单、Order Book（订单簿）、五档行情概念 |
| Day 16 | 交易成本分析 | 掌握佣金/印花税/过户费计算，理解滑点（Slippage）成因与估算方法 |
| Day 17 | 涨跌停与熔断机制 | 掌握 A 股涨跌停规则（主板10%/科创/创业20%/ST 5%），代码识别停牌股 |
| Day 18 | 回测中的「陷阱」 | 理解未来函数、幸存者偏差、偷价（开盘价/收盘价成交差异）的规避方法 |
| Day 19-20 | 手算技术指标 | 纯 Pandas 实现 MACD/KDJ/RSI 计算，理解指标数学逻辑与市场含义 |
| Day 21 | 周复盘 | 撰写《A股交易规则与量化避坑指南》 |

### Week 4: 最小可行性系统 (MVP)
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 22 | 策略基类（BaseStrategy）设计 | 基于 `abc` 模块定义 `initialize`/`handle_bar` 接口，强制接口约束 |
| Day 23 | 上下文对象（Context）设计 | 设计 `Context` 类，承载资金、持仓、时间游标核心数据 |
| Day 24 | 简易回测循环 | 编写时间轴遍历循环，调用策略逻辑 |
| Day 25 | 信号触发与记录 | 实现双均线策略，金叉打印「买入」、死叉打印「卖出」 |
| Day 26-27 | 第一次全流程联调 | 完成「下载数据 → 运行策略 → 打印交易日志」闭环 |
| Day 28-30 | 阶段一总结与休整 | 复盘第一阶段知识点，整理代码资产 |

---

## 第二阶段：核心架构与回测引擎 (Day 31 - Day 60)
**阶段目标**：实现高仿真回测引擎，支持资金结算、交易费用精准扣除

### Week 5: 账户与撮合系统（核心模块）
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 31 | Portfolio（账户）对象设计 | 实现 `total_cash`/`frozen_cash`/`market_value` 核心属性与计算逻辑 |
| Day 32 | Position（持仓）对象设计 | 实现 `avg_price`（持仓均价）、`volume`（持仓量）管理逻辑 |
| Day 33 | 模拟撮合器（Matcher）- 买入 | 实现资金校验、手续费计算、现金扣除、持仓增加逻辑 |
| Day 34 | 模拟撮合器（Matcher）- 卖出 | 实现持仓校验（T+1规则）、印花税扣除、现金增加、持仓减少逻辑 |
| Day 35 | 订单对象（Order）标准化 | 定义 `order_id`/`status`（已报/已成/废单）等核心字段，标准化订单结构 |
| Day 36-37 | 集成测试 | 手动模拟交易，验证资金计算精度（精确到小数点后2位） |

### Week 6: 回测引擎完善
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 38 | 时间驱动机制 | 完善 `BacktestEngine`，实现盘前分红派息处理、盘后净值结算 |
| Day 39 | 基准收益（Benchmark）集成 | 引入沪深300指数作为策略对比基准 |
| Day 40 | 撮合逻辑增强 | 加入滑点模拟（成交价浮动0.1%）、成交量限制（≤当日总成交量10%） |
| Day 41-42 | 绩效分析模块（Analyzer） | 实现年化收益、最大回撤、夏普比率、胜率、盈亏比计算 |
| Day 43-44 | 绘图模块 | 绘制「策略净值 vs 基准净值」曲线、「每日持仓仓位」图 |

### Week 7: 策略开发实战（经典策略）
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 45 | 网格交易策略实现 | 完成震荡市「跌买涨卖」核心逻辑 |
| Day 46 | 动量策略实现 | 完成「追涨杀跌」逻辑（买入过去20天涨幅最高股票） |
| Day 47 | 均值回归策略实现 | 完成布林带策略（下轨买入、上轨卖出） |
| Day 48-49 | 策略回测与对比 | 对比上述策略2020-2023年回测表现 |
| Day 50-51 | 调试与优化 | 掌握 Python Debugger (pdb)/IDE 断点调试复杂逻辑 |

### Week 8: 代码质量提升
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 52 | 单元测试（PyTest） | 为 `Portfolio` 资金计算逻辑编写测试用例 |
| Day 53 | 类型注解（Type Hinting） | 为所有核心函数添加类型提示，提升代码可读性 |
| Day 54 | 异常处理强化 | 规避数据缺失导致的回测崩溃问题 |
| Day 55-60 | 阶段二总结与重构 | 重构回测引擎代码，优化架构合理性 |

---

## 第三阶段：量化研究与多因子选股 (Day 61 - Day 90)
**阶段目标**：理解 Alpha 因子逻辑，构建多因子选股模型，补足量化理论短板

### Week 9: 因子理论基础
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 61 | 因子基础认知 | 理解 CAPM 模型、Alpha 与 Beta 分离逻辑 |
| Day 62 | 因子分类 | 掌握规模/价值/成长/情绪/动量因子定义与特征 |
| Day 63 | 单因子有效性检验 | 理解 IC（信息系数）/IR 计算逻辑，判断因子有效性 |
| Day 64 | 因子分层回测 | 掌握「股票按因子值分5组，看多空收益差」的验证方法 |
| Day 65-67 | 因子计算实战 | 编写代码计算流通市值(Log)、EP(市盈率倒数)、RSI强弱指标 |

### Week 10: 因子处理工艺
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 68 | 去极值（Winsorize） | 处理3倍标准差外的异常数据 |
| Day 69 | 标准化（Z-Score） | 统一不同量纲因子的计算标准，支持因子相加 |
| Day 70 | 中性化（Neutralization） | 理解剔除市值/行业影响的逻辑（高级内容，重点理解概念） |
| Day 71-74 | Alphalens 工具库集成 | 使用 Alphalens 生成专业因子分析报告 |

### Week 11: 评分模型与选股
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 75 | 多因子打分法实现 | 完成 `Score = w1*F1 + w2*F2 + ...` 加权评分逻辑 |
| Day 76 | 股票池筛选 | 过滤 ST、停牌、上市不满60天的股票 |
| Day 77 | 盘前选股器（Pipeline） | 实现 `before_trading_start` 逻辑，每日开盘前生成 `target_list` |
| Day 78-81 | 低估值高成长轮动策略 | 实现「每月调仓，持有PE低且ROE高的前30只股票」逻辑 |

### Week 12: 策略优化与过拟合规避
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 82 | 参数寻优（Grid Search） | 寻找最优持仓数量(10/30/50)、调仓周期 |
| Day 83 | 过拟合风险认知 | 理解样本内/样本外测试差异，规避「参数过度精确」的过拟合问题 |
| Day 84-90 | 阶段三实战总结 | 产出「经历史回测验证、年化收益为正」的多因子选股策略 |

---

## 第四阶段：实盘工程化与风控体系 (Day 91 - Day 120)
**阶段目标**：对接真实交易接口，建立全流程风控，实现无人值守运行

### Week 13: 实盘引擎 (LiveRunner)
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 91 | 异步交易接口掌握 | 掌握 `order_stock_async` 及回调函数 `on_order_stock_async_response` |
| Day 92 | 订单状态机实现 | 处理「已报→部成→已成→废单」状态流转逻辑 |
| Day 93 | 实盘资产同步 | 启动时从 MiniQMT 同步真实资金/持仓到 `Context` |
| Day 94 | 心跳与重连机制 | 检测 MiniQMT 断线，实现自动重连 |
| Day 95-97 | 模拟盘联调 | 盘中时段(9:30-11:30)运行实盘引擎，验证日志输出与逻辑正确性 |

### Week 14: 交易算法与风控（Risk Manager）
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 98 | 拆单算法（TWAP） | 实现「大额订单拆分（如1万股拆10笔，每5分钟1笔）」，规避市场冲击 |
| Day 99 | 事前风控 | 实现资金合规、科创板权限、黑名单过滤校验 |
| Day 100 | 自动止损风控 | 实现「个股亏损>8% 或 账户回撤>5% 时熔断清仓」逻辑 |
| Day 101-104 | 异常处理系统 | 处理下单超时、废单重发、数据源中断等极端场景 |

### Week 15: 自动化与监控
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 105 | 任务调度（APScheduler） | 配置定时任务：9:00启动数据、9:15选股、9:30交易、15:10收盘结算 |
| Day 106 | 消息推送集成 | 对接钉钉/飞书机器人，交易成交/报错时推送至手机 |
| Day 107 | 每日报表生成 | 收盘后生成 HTML 报表（今日盈亏、持仓变化），自动发送邮件 |
| Day 108-111 | 72小时无人值守压力测试 | 模拟盘连续运行3天，验证无人干预下的稳定性 |

### Week 16: 最终验收与部署
| 日期 | 核心任务 | 重点产出/掌握点 |
|------|----------|----------------|
| Day 112 | 简易 GUI 监控面板 | 使用 Streamlit 实现网页后台，可视化运行状态 |
| Day 113 | 代码冻结与清理 | 删除调试代码，完善注释，符合 PEP8 规范 |
| Day 114 | 操作手册编写 | 文档化「启动流程、参数配置、故障排查」方法 |
| Day 115-119 | 实盘小资金试跑 | 投入一手资金，验证滑点、真实成交与回测的差异 |
| Day 120 | 毕业验收 | 完成全流程量化交易系统搭建，达到无人值守运行标准 |

---

## 执行守则
1. **不跳过基础**：即使简单任务（如 Git 操作）也必须完成，夯实职业素养
2. **不贪快求进**：遇到不懂的金融名词（如分级基金下折）需彻底理解，不只为跑通代码
3. **每日复盘**：15:00收盘后花1小时分析日志，思考「策略行为逻辑」
4. **及时反馈**：遇到问题第一时间同步，避免卡壳积累
5. **保持专注**：量化交易是长期工程，需持续聚焦核心目标
6. **保持耐心**：复杂系统需反复调试，拒绝浮躁
7. **持续学习**：跟踪量化领域新技术、行业动态，保持学习热情
8. **日志记录**：养成每日学习/调试日志记录习惯，便于复盘
9. **代码规范**：严格遵循 PEP8 规范，保持代码整洁可维护
10. **协作意识**：有机会时尝试团队协作开发，提升工程化思维
11. **健康第一**：避免长时间高强度编程，注意劳逸结合